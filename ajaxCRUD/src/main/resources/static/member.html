<!DOCTYPE>
<html>
<head>
<style>
.red {
  color: red;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
	$(document).ready(function() {
		//지역변수 선언 시작
		let currentPage = 1;
		let lastPage = 0;
		let currentTenPage = 0;
		let lastTenPage = 0;
		let repetitionPage = 0;
		//지역변수 선언 종료
		
		//삭제 이벤트 시작
		$('#btnRemove').on('click',function() {
			let ck = new Array(); // let ck =[]
			$('.ck:checked').each(function(index,item){
				ck.push($(item).val());
			});
			console.log('#btnRemove click');
			$.ajax({
				url:'/removeMember'
				,type:'post'
				,data:{'ck':ck}
				,success:function(data){
					$('#btnList').trigger('click');
				}
			});
		});
		//삭제 이벤트 종료
		
		//추가 이벤트 시작
		$('#btnAdd').on('click',function() {
			console.log('#btnAdd click');
			let id = $('#id').val();
			let pw = $('#pw').val();
			let name = $('#name').val();
			let age = $('#age').val();
			let gender = $('#gender').val();
			//유효성 검사
			if(id 	== "") {
				$('h3').addClass('red');
				$('h3').text('id 미 입력');
			} else if(pw == "") {
				$('h3').addClass('red');
				$('h3').text('pw 미 입력');
			} else if(name == "") {
				$('h3').addClass('red');
				$('h3').text('name 미 입력');
			} else if(age == "") {
				$('h3').addClass('red');
				$('h3').text('age 미 입력');
			} else if(gender == "") {
				$('h3').addClass('red');
				$('h3').text('gender 미 입력');
			} else {
		 		$.ajax({
					url:'/addMember'
					,type:'post'
					,data:{'id':id,'pw':pw,'name':name,'age':age,'gender':gender}
					,success:function(data){
						$('#btnList').trigger('click');
					}
		        });
			}
		});
		//추가 이벤트 종료
		
		//수정 이벤트 시작
		$('#btnModify').on('click',function() {
			console.log('#btnModify click');
			let id = $('#id').val();
			let pw = $('#pw').val();
			let name = $('#name').val();
			let age = $('#age').val();
			let gender = $('#gender').val();
			//유효성 검사
			if(id 	== "") {
				$('h3').addClass('red');
				$('h3').text('id 미 입력');
			} else if(pw == "") {
				$('h3').addClass('red');
				$('h3').text('pw 미 입력');
			} else if(name == "") {
				$('h3').addClass('red');
				$('h3').text('name 미 입력');
			} else if(age == "") {
				$('h3').addClass('red');
				$('h3').text('age 미 입력');
			} else if(gender == "") {
				$('h3').addClass('red');
				$('h3').text('gender 미 입력');
			} else {
				$.ajax({
					url:'/modifyMember'
					,type:'post'
					,data:{'id':id,'pw':pw,'name':name,'age':age,'gender':gender}
					,success:function(data){
						$('#btnList').trigger('click');
					}
				});
			}
		});
		//수정 이벤트 종료
		
		//목록 이벤트 시작
		$('#btnList').on('click',function() {
			console.log('#btnList click');
			$.ajax({
				url:'/getMembers'
				,type:'get'
				,data:{'currentPage':currentPage}
				,success:function(data){
					$('#list').empty();
 					$('#btnNext').hide();
 					$('#btnPage2').hide();
 					$('#btnPage3').hide();
 					$('#btnPage4').hide();
 					$('#btnPage5').hide();
 					$('#btnPage6').hide();
 					$('#btnPage7').hide();
 					$('#btnPage8').hide();
 					$('#btnPage9').hide();
 					$('#btnPage10').hide();
 					$('#btnPrevious').hide();
					$(data.list).each(function(index,item){
						$('#list').append('<tr>');
						$('#list').append('<td><input type="checkbox" class="ck" value="'+item.id+'"></td>');
						$('#list').append('<td>'+item.id+'</td>');
						$('#list').append('<td>'+item.pw+'</td>');
						$('#list').append('<td>'+item.name+'</td>');
						$('#list').append('<td>'+item.age+'</td>');
						$('#list').append('<td>'+item.gender+'</td>');
						$('#list').append('</tr>');
					});
					currentPage = parseInt(data.currentPage);
					currentTenPage = parseInt(data.currentTenPage);
					lastPage = parseInt(data.lastPage);
					lastTenPage = parseInt(data.lastTenPage);
					repetitionPage = parseInt(data.repetitionPage);
					console.log('현재페이지' + currentPage);
					console.log('반복횟수' + repetitionPage);
					console.log('마지막페이지' + lastPage);
					let showPageNumber = currentTenPage*10+1;
					$('#btnPage1').text(showPageNumber);
 					if(currentPage > 10){
						$('#btnPrevious').show();
					}
					if(currentTenPage < lastTenPage){
						$('#btnNext').show();	
					}
					for(let i = 1; i<repetitionPage; i++){
						if(repetitionPage > i){
							let n = i+1;
							let btnPage = '#btnPage'+n
							showPageNumber = currentTenPage*10+n;
							$(btnPage).show();
							$(btnPage).text(showPageNumber);
						}
					}				
				}
			});
		});
		//목록 이벤트 종료
		
		//페이지 시작시 목록 이벤트 시작 하기
 		$('#btnList').trigger('click');
 		
 		//이전페이지 이벤트 시작
 		$('#btnPrevious').on('click',function() {
 			console.log('#btnPrevious');
 			currentPage = currentTenPage*10;
 			$('#btnList').trigger('click');
 		});
 		//이전페이지 이벤트 종료
 		
 		//페이지넘버 버튼 이벤트 시작
 		$('#btnPage1').on('click',function() {
 			console.log('#btnPage1');
 			currentPage = currentTenPage*10+1;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage2').on('click',function() {
 			console.log('#btnPage2');
 			currentPage = currentTenPage*10+2;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage3').on('click',function() {
 			console.log('#btnPage3');
 			currentPage = currentTenPage*10+3;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage4').on('click',function() {
 			console.log('#btnPage1');
 			currentPage = currentTenPage*10+4;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage5').on('click',function() {
 			console.log('#btnPage1');
 			currentPage = currentTenPage*10+5;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage6').on('click',function() {
 			console.log('#btnPage1');
 			currentPage = currentTenPage*10+6;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage7').on('click',function() {
 			console.log('#btnPage1');
 			currentPage = currentTenPage*10+7;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage8').on('click',function() {
 			console.log('#btnPage1');
 			currentPage = currentTenPage*10+8;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage9').on('click',function() {
 			console.log('#btnPage1');
 			currentPage = currentTenPage*10+9;
 			$('#btnList').trigger('click');
 		});
 		$('#btnPage10').on('click',function() {
 			console.log('#btnPage1');
 			currentPage = (currentTenPage+1)*10;
 			$('#btnList').trigger('click');
 		});
 		//페이지넘버 버튼 이벤트 종료
 		
 		//다음페이지 이벤트 시작
 		$('#btnNext').on('click',function() {
 			console.log('#btnNext');
 			currentPage = (currentTenPage+1)*10+1;
 			$('#btnList').trigger('click');
 		});
 		//다음페이지 이벤트 종료
	});
	
	//나이 입력 유효성 검사 시작
	function checkAge(event){
		event = event || window.event;
		let keyID = (event.which) ? event.which : event.keyCode;
		if( ( keyID >=48 && keyID <= 57 ) || ( keyID >=96 && keyID <= 105 ) || keyID == 8 ||  keyID == 46 || keyID == 37 || keyID == 39) {
			$('h3').empty();
			return;
		} else {
			$('h3').addClass('red');
			$('h3').text('나이입력란에는 숫자만 입력하세요.');
			return false;
		}
	};
	//한글입력에 의한 버그 수정 시작
	function removeChar(event) {
		event = event || window.event;
		let keyID = (event.which) ? event.which : event.keyCode;
		if( keyID == 8 || keyID == 46 || keyID == 37 || keyID == 39 ) {
			return;
		} else {
			event.target.value = event.target.value.replace(/[^0-9]/g, "");
		}
	};
	//한글입력에 의한 버그 수정 종료
	//나이입력 유효성 검사 종료
	
	//id입력 유효성 검사 시작
	function checkId(event){
		event = event || window.event;
		let keyID = (event.which) ? event.which : event.keyCode;
		if( keyID == 32 ) {
			$('h3').addClass('red');
			$('h3').text('id입력란에는 공백을 입력할수 없습니다.');
			return false;
		} else {
			$('h3').empty();
			return;
		}
	};
	//id입력 유효성 검사 종료

	//pw입력 유효성 검사 시작
	function checkPw(event){
		event = event || window.event;
		let keyID = (event.which) ? event.which : event.keyCode;
		if( keyID == 32 ) {
			$('h3').addClass('red');
			$('h3').text('pw입력란에는 공백을 입력할수 없습니다.');
			return false;
		} else {
			$('h3').empty();
			return;
		}
	};
	//pw입력 유효성 검사 종료
	
	//name입력 유효성 검사 시작
	function checkName(event){
		event = event || window.event;
		let keyID = (event.which) ? event.which : event.keyCode;
		if( keyID == 32 ) {
			$('h3').addClass('red');
			$('h3').text('name입력란에는 공백을 입력할수 없습니다.');
			return false;
		} else {
			$('h3').empty();
			return;
		}
	};
	//name입력 유효성 검사 종료
</script>
</head>
<body>
	<h3></h3>
	<table border="1">
		<thead>
			<tr>
				<th>id</th>
				<th>pw</th>
				<th>name</th>
				<th>age</th>
				<th>gender</th>
				<th>추가</th>
				<th>수정</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><input type="text" onkeydown="return checkId(event)" id="id"></td>
				<td><input type="password" onkeydown="return checkPw(event)" id="pw"></td>
				<td><input type="text" onkeydown="return checkName(event)" id="name"></td>
				<td><input type="text"  onkeyup="removeChar(event)" onkeydown="return checkAge(event)" id="age"></td>
				<td>
					<select id="gender">
						<option value="Male">남</option>
						<option value="Female">여</option>
					</select>
				</td>
				<td><button type="button" id="btnAdd">add</button></td>
				<td><button type="button" id="btnModify">modify</button></td>
			</tr>
		</tbody>
	</table>
	<button type="button" id="btnList">회원리스트</button>
	<button type="button" id="btnRemove">remove</button>
	<table border="1">
		<thead>
			<tr>
				<th></th>
				<th>id</th>
				<th>pw</th>
				<th>name</th>
				<th>age</th>
				<th>gender</th>
			</tr>
		</thead>
		<tbody id="list">
		</tbody>
	</table>
	<div id="paging">
		<button type="button" id="btnPrevious">previous</button>
		<button type="button" id="btnPage1" class="btnPage"></button>
		<button type="button" id="btnPage2" class="btnPage"></button>
		<button type="button" id="btnPage3" class="btnPage"></button>
		<button type="button" id="btnPage4" class="btnPage"></button>
		<button type="button" id="btnPage5" class="btnPage"></button>
		<button type="button" id="btnPage6" class="btnPage"></button>
		<button type="button" id="btnPage7" class="btnPage"></button>
		<button type="button" id="btnPage8" class="btnPage"></button>
		<button type="button" id="btnPage9" class="btnPage"></button>
		<button type="button" id="btnPage10" class="btnPage"></button>
		<button type="button" id="btnNext">next</button>
	</div>
</body>
</html>